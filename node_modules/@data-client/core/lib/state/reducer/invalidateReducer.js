import { INVALIDATE_TYPE } from '../../actionTypes.js';
export function invalidateReducer(state, action) {
  const results = {
    ...state.results
  };
  const meta = {
    ...state.meta
  };
  const invalidateKey = key => {
    delete results[key];
    const itemMeta = {
      ...meta[key],
      expiresAt: 0,
      invalidated: true
    };
    delete itemMeta.error;
    meta[key] = itemMeta;
  };
  if (action.type === INVALIDATE_TYPE) {
    invalidateKey(action.meta.key);
  } else {
    Object.keys(results).forEach(key => {
      if (action.testKey(key)) {
        invalidateKey(key);
      }
    });
  }
  return {
    ...state,
    results,
    meta
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJTlZBTElEQVRFX1RZUEUiLCJpbnZhbGlkYXRlUmVkdWNlciIsInN0YXRlIiwiYWN0aW9uIiwicmVzdWx0cyIsIm1ldGEiLCJpbnZhbGlkYXRlS2V5Iiwia2V5IiwiaXRlbU1ldGEiLCJleHBpcmVzQXQiLCJpbnZhbGlkYXRlZCIsImVycm9yIiwidHlwZSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwidGVzdEtleSJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zdGF0ZS9yZWR1Y2VyL2ludmFsaWRhdGVSZWR1Y2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElOVkFMSURBVEVfVFlQRSB9IGZyb20gJy4uLy4uL2FjdGlvblR5cGVzLmpzJztcbmltcG9ydCB0eXBlIHtcbiAgU3RhdGUsXG4gIEludmFsaWRhdGVBbGxBY3Rpb24sXG4gIEludmFsaWRhdGVBY3Rpb24sXG59IGZyb20gJy4uLy4uL3R5cGVzLmpzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGludmFsaWRhdGVSZWR1Y2VyKFxuICBzdGF0ZTogU3RhdGU8dW5rbm93bj4sXG4gIGFjdGlvbjogSW52YWxpZGF0ZUFjdGlvbiB8IEludmFsaWRhdGVBbGxBY3Rpb24sXG4pIHtcbiAgY29uc3QgcmVzdWx0cyA9IHsgLi4uc3RhdGUucmVzdWx0cyB9O1xuICBjb25zdCBtZXRhID0geyAuLi5zdGF0ZS5tZXRhIH07XG4gIGNvbnN0IGludmFsaWRhdGVLZXkgPSAoa2V5OiBzdHJpbmcpID0+IHtcbiAgICBkZWxldGUgcmVzdWx0c1trZXldO1xuICAgIGNvbnN0IGl0ZW1NZXRhID0ge1xuICAgICAgLi4ubWV0YVtrZXldLFxuICAgICAgZXhwaXJlc0F0OiAwLFxuICAgICAgaW52YWxpZGF0ZWQ6IHRydWUsXG4gICAgfTtcbiAgICBkZWxldGUgaXRlbU1ldGEuZXJyb3I7XG4gICAgbWV0YVtrZXldID0gaXRlbU1ldGE7XG4gIH07XG4gIGlmIChhY3Rpb24udHlwZSA9PT0gSU5WQUxJREFURV9UWVBFKSB7XG4gICAgaW52YWxpZGF0ZUtleShhY3Rpb24ubWV0YS5rZXkpO1xuICB9IGVsc2Uge1xuICAgIE9iamVjdC5rZXlzKHJlc3VsdHMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGlmIChhY3Rpb24udGVzdEtleShrZXkpKSB7XG4gICAgICAgIGludmFsaWRhdGVLZXkoa2V5KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgLi4uc3RhdGUsXG4gICAgcmVzdWx0cyxcbiAgICBtZXRhLFxuICB9O1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxlQUFlLFFBQVEsc0JBQXNCO0FBT3RELE9BQU8sU0FBU0MsaUJBQWlCQSxDQUMvQkMsS0FBcUIsRUFDckJDLE1BQThDLEVBQzlDO0VBQ0EsTUFBTUMsT0FBTyxHQUFHO0lBQUUsR0FBR0YsS0FBSyxDQUFDRTtFQUFRLENBQUM7RUFDcEMsTUFBTUMsSUFBSSxHQUFHO0lBQUUsR0FBR0gsS0FBSyxDQUFDRztFQUFLLENBQUM7RUFDOUIsTUFBTUMsYUFBYSxHQUFJQyxHQUFXLElBQUs7SUFDckMsT0FBT0gsT0FBTyxDQUFDRyxHQUFHLENBQUM7SUFDbkIsTUFBTUMsUUFBUSxHQUFHO01BQ2YsR0FBR0gsSUFBSSxDQUFDRSxHQUFHLENBQUM7TUFDWkUsU0FBUyxFQUFFLENBQUM7TUFDWkMsV0FBVyxFQUFFO0lBQ2YsQ0FBQztJQUNELE9BQU9GLFFBQVEsQ0FBQ0csS0FBSztJQUNyQk4sSUFBSSxDQUFDRSxHQUFHLENBQUMsR0FBR0MsUUFBUTtFQUN0QixDQUFDO0VBQ0QsSUFBSUwsTUFBTSxDQUFDUyxJQUFJLEtBQUtaLGVBQWUsRUFBRTtJQUNuQ00sYUFBYSxDQUFDSCxNQUFNLENBQUNFLElBQUksQ0FBQ0UsR0FBRyxDQUFDO0VBQ2hDLENBQUMsTUFBTTtJQUNMTSxNQUFNLENBQUNDLElBQUksQ0FBQ1YsT0FBTyxDQUFDLENBQUNXLE9BQU8sQ0FBQ1IsR0FBRyxJQUFJO01BQ2xDLElBQUlKLE1BQU0sQ0FBQ2EsT0FBTyxDQUFDVCxHQUFHLENBQUMsRUFBRTtRQUN2QkQsYUFBYSxDQUFDQyxHQUFHLENBQUM7TUFDcEI7SUFDRixDQUFDLENBQUM7RUFDSjtFQUVBLE9BQU87SUFDTCxHQUFHTCxLQUFLO0lBQ1JFLE9BQU87SUFDUEM7RUFDRixDQUFDO0FBQ0gifQ==